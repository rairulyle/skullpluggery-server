name: utilities

networks:
  default:
    name: ${NETWORK_NAME}
    external: true

services:
  watchtower:
    container_name: watchtower
    image: nickfedor/watchtower:latest
    hostname: SKULLSERVER
    environment:
      WATCHTOWER_CLEANUP: true
      WATCHTOWER_NOTIFICATIONS: shoutrrr
      WATCHTOWER_NOTIFICATION_URL: "discord://${DISCORD_TOKEN}@${DISCORD_ID}"
      WATCHTOWER_SCHEDULE: "0 0 * * *" # every 12:00 AM every day
      TZ: ${TZ}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${APP_DATA}/watchtower/config.json:/config.json
    restart: unless-stopped
    labels:
      net.unraid.docker.icon: https://raw.githubusercontent.com/homarr-labs/dashboard-icons/refs/heads/main/png/watchtower.png

  speedtest-tracker:
    container_name: speedtest-tracker
    image: lscr.io/linuxserver/speedtest-tracker:latest
    ports:
      - "8081:80"
    environment:
      PUID: 1000
      PGID: 1000
      SPEEDTEST_SCHEDULE: 0 */2 * * *
      PRUNE_RESULTS_OLDER_THAN: 90
      TZ: ${TZ}
      APP_KEY: ${SPEEDTEST_APP_KEY}
    volumes:
      - ${APP_DATA}/speedtest-tracker:/config
    restart: unless-stopped
    labels:
      npm.proxy.domain: speedtest.${DOMAIN_NAME}
      npm.proxy.port: "8081"
      net.unraid.docker.icon: https://raw.githubusercontent.com/homarr-labs/dashboard-icons/refs/heads/main/png/speedtest-tracker.png
      net.unraid.docker.webui: http://speedtest.${DOMAIN_NAME}

  meralco-ph:
    container_name: meralco-ph
    image: ghcr.io/rairulyle/meralco-ph:latest
    ports:
      - "5000:5000"
    environment:
      TZ: ${TZ}
    restart: unless-stopped

  upsnap:
    container_name: upsnap
    image: ghcr.io/seriousm4x/upsnap:5
    network_mode: host
    environment:
      TZ: ${TZ}
    volumes:
      - ${APP_DATA}/upsnap:/app/pb_data
    restart: unless-stopped
    labels:
      npm.proxy.domain: upsnap.${DOMAIN_NAME}
      npm.proxy.port: "8090"
      net.unraid.docker.icon: https://raw.githubusercontent.com/homarr-labs/dashboard-icons/refs/heads/main/png/upsnap.png
      net.unraid.docker.webui: http://upsnap.${DOMAIN_NAME}

  tautulli:
    container_name: tautulli
    image: lscr.io/linuxserver/tautulli:latest
    ports:
      - 8181:8181
    environment:
      PUID: 1000
      PGID: 1000
      TZ: ${TZ}
    volumes:
      - ${APP_DATA}/tautulli:/config
    restart: unless-stopped
    labels:
      npm.proxy.domain: tautulli.${DOMAIN_NAME}
      npm.proxy.port: "8181"
      net.unraid.docker.icon: https://raw.githubusercontent.com/homarr-labs/dashboard-icons/refs/heads/main/png/tautulli.png
      net.unraid.docker.webui: http://tautulli.${DOMAIN_NAME}
